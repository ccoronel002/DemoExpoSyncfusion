@using Syncfusion.EJ2;
@using EJ2MVCSampleBrowser.Models;

@section ControlsSection{
    <div class="col-lg-8 control-section" style="float:left; padding:0px">
        @Html.EJS().Diagram("diagram").Width("100%").Height("580px").Created("create").GetNodeDefaults("nodeDefaults").GetConnectorDefaults("connectorDefaults").DataSourceSettings(ss => ss.Id("Name").ParentId("ReportingPersons")
.DataManager(new DataManager() { Data = (List<ComplexHierarchicalDataDetails>)ViewBag.Nodes })).Layout(l => l.Type(Syncfusion.EJ2.Diagrams.LayoutType.ComplexHierarchicalTree).HorizontalSpacing(40).VerticalSpacing(40)).SnapSettings(s => s.Constraints(Syncfusion.EJ2.Diagrams.SnapConstraints.None)).Render();
    </div>
    <div class="col-lg-4 property-section" style="float:right;margin-top:10px">
        <div class="property-panel-header">
            Layout Settings
        </div>
        <div class="row" id="appearance" style="padding-top: 10px">
            <div class="row row-header">
                Orientation
            </div>
            <div class="row" style="padding-top: 8px">
                <div class="image-pattern-style  e-selected-style" id="toptobottom" style="background-image: url('Content/images/diagram/Images/common-orientation/toptobottom.png'); margin-right: 3px">
                </div>
                <div class="image-pattern-style" id="bottomtotop" style="background-image: url('Content/images/diagram/Images/common-orientation/bottomtotop.png'); margin: 0px 3px">
                </div>
                <div class="image-pattern-style" id="lefttoright" style="background-image: url('Content/images/diagram/Images/common-orientation/lefttoright.png'); margin-right: 3px">
                </div>
            </div>
            <div class="row" style="padding-top: 8px">
                <div class="image-pattern-style" id="righttoleft" style="background-image: url('Content/images/diagram/Images/common-orientation/righttoleft.png'); margin: 0px 3px">
                </div>
            </div>
        </div>
        <div class="row" style="padding-top: 10px">
            <div class="row row-header">
                Behavior
            </div>
            <div class="row" style="padding-top: 8px">
                <div style="display: table;height: 35px; padding-left: 0px" class="col-xs-5">
                    <div style="display: table-cell; vertical-align: middle">Margin X</div>
                </div>
                <div class="col-xs-7">
                    @Html.EJS().NumericTextBox("marginLeft").Change("marginLeftChange").Width("110px").Min(20).Max(60).Step(1).Format("##.##").Value(40).Render()
                </div>
            </div>
            <div class="row" style="padding-top: 8px">
                <div style="display: table;height: 35px; padding-left: 0px" class="col-xs-5">
                    <div style="display: table-cell; vertical-align: middle">Margin Y</div>
                </div>
                <div class="col-xs-7">
                    @Html.EJS().NumericTextBox("marginTop").Change("marginTopChange").Width("110px").Min(20).Max(60).Step(1).Format("##.##").Value(40).Render()
                </div>
            </div>
            <div class="row" style="padding-top: 8px">
                <div style="display: table;height: 35px; padding-left: 0px" class="col-xs-5">
                    <div style="display: table-cell; vertical-align: middle">Horizontal Spacing</div>
                </div>
                <div class="col-xs-7">
                    @Html.EJS().NumericTextBox("hSpacing").Change("hSpacingChange").Width("110px").Min(20).Max(60).Step(1).Format("##.##").Value(40).Render()
                </div>
            </div>
            <div class="row" style="padding-top: 8px">
                <div style="display: table;height: 35px; padding-left: 0px" class="col-xs-5">
                    <div style="display: table-cell; vertical-align: middle">Vertical Spacing</div>
                </div>
                <div class="col-xs-7">
                    @Html.EJS().NumericTextBox("vSpacing").Change("vSpacingChange").Width("110px").Min(20).Max(60).Step(1).Format("##.##").Value(40).Render()
                </div>
            </div>
        </div>
    </div>
    <style>
        #diagram {
            display: block;
        }

        .row {
            display: block;
        }

        .image-pattern-style {
            background-color: white;
            background-size: contain;
            background-repeat: no-repeat;
            height: 75px;
            width: calc((100% - 18px) / 3);
            cursor: pointer;
            border: 1px solid #D5D5D5;
            background-position: center;
            float: left;
        }

        .row {
            margin-left: 0px;
            margin-right: 0px;
        }

        .row-header {
            font-size: 15px;
            font-weight: 500;
        }

        .e-selected-style {
            border-color: #006CE6;
            border-width: 2px;
        }

        .property-panel-header {
            padding-top: 2px;
            padding-bottom: 5px;
        }

        .e-checkbox-wrapper .e-label {
            font-size: 12px;
        }

        .col-xs-6 {
            padding-left: 0px;
            padding-right: 0px;
        }
    </style>

    <script>
        function create() {
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.tool = ej.diagrams.DiagramTools.ZoomPan;
            diagram.dataBind();
        }
        function hSpacingChange(args) {
            var hSpacing = document.getElementById("hSpacing");
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.layout.horizontalSpacing = Number(hSpacing.value);
            diagram.dataBind();
        }
        function vSpacingChange(args) {
            var vSpacing = document.getElementById("vSpacing");
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.layout.verticalSpacing = Number(vSpacing.value);
            diagram.dataBind();
        }
        function marginTopChange(args) {
            var topmargin = document.getElementById("marginTop");
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.layout.margin.top = Number(topmargin.value);
            diagram.dataBind();
        }
        function marginLeftChange(args) {
            var leftmargin = document.getElementById("marginLeft");
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.layout.margin.left = Number(leftmargin.value);
            diagram.dataBind();
        }
        function connectorDefaults(connector, diagram) {
            connector.type = 'Orthogonal';
            connector.cornerRadius = 7;
            connector.targetDecorator.height = 7;
            connector.targetDecorator.width = 7;
            connector.style.strokeColor = '#6d6d6d';
            return connector;
        }

        function nodeDefaults(obj, diagram) {
            obj.style = { fill: obj.data.Color, strokeColor: 'none', strokeWidth: 2 };
            obj.width = 40; obj.height = 40;
            //Initialize shape
            obj.shape = { type: 'Basic', shape: 'Rectangle', cornerRadius: 7 };
            return obj;
        }
        document.getElementById('appearance').onclick = function (args) {
            var target = args.target;
            var selectedElement = document.getElementsByClassName('e-selected-style');
            if (selectedElement.length) {
                selectedElement[0].classList.remove('e-selected-style');
            }
            if (target.className === 'image-pattern-style') {
                switch (target.id) {
                    case 'toptobottom':
                        updateLayout(target, 'TopToBottom');
                        break;
                    case 'bottomtotop':
                        updateLayout(target, 'BottomToTop');
                        break;
                    case 'lefttoright':
                        updateLayout(target, 'LeftToRight');
                        break;
                    case 'righttoleft':
                        updateLayout(target, 'RightToLeft');
                        break;
                }
            }
        };
        function updateLayout(target, orientation) {
            var diagram = document.getElementById("diagram").ej2_instances[0];
            diagram.layout.orientation = orientation;
            diagram.dataBind();
            diagram.doLayout();
            target.classList.add('e-selected-style');
        }
    </script>
}
@section ActionDescription{
    <p>
        This sample demonstrates a complex hierarchical template that is built from an external data source using complex hierarchical tree algorithm.
    </p>
}
@section Description{
    <p>
        In this example, you can see how to generate a complex hierarchical tree from external data sources. You can also customize spacing between the objects in the tree. You can use the
        <code>horizontalSpacing</code> and <code>verticalSpacing</code> properties of <code>layout</code> to customize the space between the objects in the tree. You can use the <code>layoutOrientation</code> property of
        <code>layout</code> to change the orientation of the tree.
    </p>
    <p>
        To change the orientation of the tree, click the templates in the property panel.
    </p>
    <br>
}
